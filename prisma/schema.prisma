generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id       Int      @id @default(autoincrement())
  username String   @db.VarChar(50)
  password String   @db.VarChar(100)
  email    String   @db.VarChar(100)
  nickname String   @db.VarChar(50)
  reports  Report[] @relation("UserReports")

  @@map("users")
}

model Report {
  id         Int          @id @default(autoincrement())
  title      String       @db.VarChar(100)
  createdAt  DateTime     @default(now()) @map("created_at")
  status     ReportStatus
  userId     Int          @map("user_id")
  reflection String?
  feedback   Feedback?    @relation("ReportFeedback")
  questions  Question[]   @relation("ReportQuestions")
  user       User         @relation("UserReports", fields: [userId], references: [id])

  @@map("reports")
}

model Feedback {
  reportId    Int    @id @map("report_id")
  score       Int
  strength    String
  improvement String
  report      Report @relation("ReportFeedback", fields: [reportId], references: [id])

  @@map("feedbacks")
}

model Question {
  id           Int     @id @default(autoincrement())
  question     String
  sampleAnswer String? @map("sample_answer")
  userAnswer   String? @map("user_answer")
  recording    String?
  reportId     Int     @map("report_id")
  report       Report  @relation("ReportQuestions", fields: [reportId], references: [id])

  @@map("questions")
}

enum ReportStatus {
  분석중
  분석완료
  미응시
}
